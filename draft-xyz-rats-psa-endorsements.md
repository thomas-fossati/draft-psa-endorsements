---
title: Arm's Platform Security Architecture (PSA) Attestation Verifier Endorsements
docname: draft-xyz-rats-psa-endorsements
date: {DATE}
category: info
ipr: trust200902
area: Security
workgroup: RATS

stand_alone: yes
pi:

  rfcedstyle: yes
  toc: yes
  tocindent: yes
  sortrefs: yes
  symrefs: yes
  strict: yes
  comments: yes
  text-list-symbols: -o*+
  docmapping: yes

author:

-
  name: Thomas Fossati
  org: Arm Ltd
  email: thomas.fossati@arm.com

-
  name: Yogesh Deshpande
  org: Arm Ltd
  email: yogesh.deshpande@arm.com

normative:
  PSA-TOKEN: I-D.tschofenig-rats-psa-token

--- abstract

This memo describes a CoMID profile to convey PSA Endorsements.

PSA Endorsements comprise all the reference values, cryptographic key material
and certification status information that a Verifier needs to appraise PSA
Evidence.

--- middle

# Introduction

PSA Endorsements comprise all the reference values, cryptographic key material
and certification related information that a Verifier needs in order to appraise
Evidence produced by a PSA device {{PSA-TOKEN}}.

This memo profiles and extends the CoMID data model to accommodate PSA specific
requirements.

# Conventions and Definitions

{::boilerplate bcp14}

The reader is familiar with the terms defined in Section 2.1 of {{PSA-TOKEN}}.

# PSA Endorsements
{: #sec-psa-endorsements }

PSA Endorsements describe an attesting device in terms of the hardware and
firmware components that make up its PSA Root of Trust (RoT).  This includes
the identification and expected state of the device as well as the
cryptographic key material needed to verify Evidence signed by the device's PSA
RoT.  Additionally, PSA Endorsements can include information related to the
certification status of the attesting device.

There are two basic types of PSA endorsements:

* Reference Values ({{sec-ref-values}}), i.e., measurements of the PSA RoT
  firmware;
* Identity Claims ({{sec-identity}}), i.e., cryptographic keys that can verify
  the signature on Evidence generated by the attestation endpoint.

## Reference Values
{: #sec-ref-values}

Reference Values carry measurements and other metadata associated with the
updatable firmware in a PSA RoT.  They are associated with their PSA RoT via
the Implementation ID (see Section 3.2.2 of {{PSA-TOKEN}}).  When appraising
Evidence, the Verifier compares Reference Values against the values found in
the Software Components of the PSA token (see Section 3.4.1 of {{PSA-TOKEN}}).

Each measurement is encoded in a CoMID reference value.

The metadata associated with the measurement are encoded in a `psa-refval-meta`
structure:

~~~
{::include psa-ext/refval-meta.cddl}
~~~

The Implementation ID is encoded using the module type (2) in the element name
map using the `tagged-impl-id` type.

The example in {{ex-reference-value}} shows a CoMID reference carrying a
firmware measurement associated with Implementation ID
`acme-implementation-id-000000001`.

~~~
{::include examples/ref-value.diag}
~~~
{: #ex-reference-value title="Example Reference Value"}

## Identity
{: #sec-identity}

Identity Claims carry the verification key associated with the Initial
Attestation Key (IAK) of a PSA device.

Each verification key is encoded alongside the corresponding device Instance ID
in a CoMID identity claim.

The Instance ID is encoded using `tagged-ueid` as `$device-id-type`.

The IAK public key is encoded as a COSE Key according to Section 7 of
{{!RFC8152}} and wrapped in the `COSE_KeySet`.  The number of items in the
`COSE_KeySet` MUST be 1.

The example in {{ex-identity-claim}} shows a CoMID identity claim carrying a
secp256r1 EC public IAK associated with Instance ID `4ca3...d296`.

~~~
{::include examples/instance-pub.diag}
~~~
{: #ex-identity-claim title="Example Identity Claim"}

## Example

TODO

# Security Considerations

TODO

# IANA Considerations

TODO

# Acknowledgements
{: numbered="no"}

John Mattsson was nice enough to point out the need for this being documented.
